<!DOCTYPE html><html lang="en" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.5.5"><title>GopherHack</title><link rel="stylesheet" href="/_astro/poster.B_Cpo-Oc.css">
<link rel="stylesheet" href="/_astro/_name_.B51i_3Fs.css">
<link rel="stylesheet" href="/_astro/_post_.aVDCQf0I.css"></head> <body data-astro-cid-sckkx6r4> <section class="mainSection" data-astro-cid-sckkx6r4> <div class="content" data-astro-cid-sckkx6r4> <header data-astro-cid-sckkx6r4> <div data-astro-cid-sckkx6r4> <!-- left --> <a href="/" id="logo" data-astro-cid-sckkx6r4>
&#x1F6A9; GopherHack</a> </div> <div data-astro-cid-sckkx6r4> <!-- right --> <div class="links" data-astro-cid-sckkx6r4> <a href="/pages/contests" data-astro-cid-sckkx6r4>Contests</a> <a href="/pages/blog" data-astro-cid-sckkx6r4>Blog</a> <a href="/pages/resources" data-astro-cid-sckkx6r4>Resources</a> <a href="/pages/officers" data-astro-cid-sckkx6r4>Officers</a> </div> <div class="buttons" data-astro-cid-sckkx6r4></div> </div> </header> <main data-astro-cid-sckkx6r4>  <h1 data-astro-cid-quoef3qp>  Nullcon Goa HackIM 2025 CTF: Crahp </h1> <div class="metadata" data-astro-cid-quoef3qp> <div title="2025-02-02T12:13:04.998Z" data-astro-cid-quoef3qp> Sunday, February 2, 2025 </div> <div data-astro-cid-quoef3qp>
Authored by <a href="/authors/dajeff">dajeff</a> </div> <div data-astro-cid-quoef3qp>
CTF:  <a href="/pages/contests#ctftime-2642" data-astro-cid-quoef3qp>  </a> </div> <div data-astro-cid-quoef3qp>Tags: web</div> </div> <div class="postContent" data-astro-cid-quoef3qp> <link rel="stylesheet" href="/_astro/styles.DHdN6dA9.css"/>
<blockquote>
<p>Oh Crahp, I forgot my credentials! Can you login nontheless?</p>
<p>Author: @gehaxelt</p>
<p><a href="http://52.59.124.14:5006">http://52.59.124.14:5006</a></p>
</blockquote>
<p>The source at <a href="http://52.59.124.14:5006/?source">http://52.59.124.14:5006/?source</a> indicates that our goal is to find a password that is not equal to <code>$MYPASSWORD = &quot;AdM1nP@assW0rd!&quot;</code> yet has the same length, <code>crc16</code>, and <code>crc8</code> checksum.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="php"><code><span class="line"><span style="color:#E1E4E8">$MYPASSWORD </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;AdM1nP@assW0rd!&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">include</span><span style="color:#9ECBFF"> &quot;flag.php&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">isset</span><span style="color:#E1E4E8">($_POST[</span><span style="color:#9ECBFF">&#39;password&#39;</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#79B8FF"> strlen</span><span style="color:#E1E4E8">($MYPASSWORD) </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> strlen</span><span style="color:#E1E4E8">($_POST[</span><span style="color:#9ECBFF">&#39;password&#39;</span><span style="color:#E1E4E8">])) {</span></span>
<span class="line"><span style="color:#E1E4E8">    $pwhash1 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc16</span><span style="color:#E1E4E8">($MYPASSWORD);</span></span>
<span class="line"><span style="color:#E1E4E8">    $pwhash2 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc8</span><span style="color:#E1E4E8">($MYPASSWORD);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    $password </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> $_POST[</span><span style="color:#9ECBFF">&#39;password&#39;</span><span style="color:#E1E4E8">];</span></span>
<span class="line"><span style="color:#E1E4E8">    $pwhash3 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc16</span><span style="color:#E1E4E8">($password);</span></span>
<span class="line"><span style="color:#E1E4E8">    $pwhash4 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc8</span><span style="color:#E1E4E8">($password);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8">($MYPASSWORD </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> $password) {</span></span>
<span class="line"><span style="color:#F97583">        die</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;oops. Try harder!&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8">($pwhash1 </span><span style="color:#F97583">!=</span><span style="color:#E1E4E8"> $pwhash3) {</span></span>
<span class="line"><span style="color:#F97583">        die</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;Oops. Nope. Try harder!&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8">($pwhash2 </span><span style="color:#F97583">!=</span><span style="color:#E1E4E8"> $pwhash4) {</span></span>
<span class="line"><span style="color:#F97583">        die</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;OoOps. Not quite. Try harder!&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">    $access </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8">($access) {</span></span>
<span class="line"><span style="color:#79B8FF">        echo</span><span style="color:#9ECBFF"> &quot;You win a flag: </span><span style="color:#E1E4E8">$FLAG</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">        echo</span><span style="color:#9ECBFF"> &quot;Denied! :-(&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">} </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">    echo</span><span style="color:#9ECBFF"> &quot;Try harder!&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p><code>crc8</code> and <code>crc16</code> produce 8-bit and 16-bit checksums respectively, which we can verify by checking <code>crc8(&quot;AdM1nP@assW0rd!&quot;)</code> and <code>crc16(&quot;AdM1nP@assW0rd!&quot;)</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="php"><code><span class="line"><span style="color:#E1E4E8">$c8 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc8</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;AdM1nP@assW0rd!&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">$c16 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc16</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;AdM1nP@assW0rd!&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $c8;  </span><span style="color:#6A737D">// 167</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $c16;  </span><span style="color:#6A737D">// 25010</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">;</span></span></code></pre>
<p>We should therefore expect to test around <code>(2 ** 8) * (2 ** 16) = 16777216</code> strings before we find a collision, which is brute-forceable.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="php"><code><span class="line"><span style="color:#E1E4E8">$c8 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc8</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;AdM1nP@assW0rd!&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">$c16 </span><span style="color:#F97583">=</span><span style="color:#B392F0"> crc16</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;AdM1nP@assW0rd!&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> ($x </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 100000010000000</span><span style="color:#E1E4E8">; $x </span><span style="color:#F97583">&lt;=</span><span style="color:#79B8FF"> 100000000000000</span><span style="color:#F97583"> +</span><span style="color:#79B8FF"> 1e8</span><span style="color:#E1E4E8">; $x</span><span style="color:#F97583">++</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">crc8</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">strval</span><span style="color:#E1E4E8">($x)) </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> $c8 </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#B392F0"> crc16</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">strval</span><span style="color:#E1E4E8">($x)) </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> $c16) {</span></span>
<span class="line"><span style="color:#79B8FF">        echo</span><span style="color:#79B8FF"> strval</span><span style="color:#E1E4E8">($x);</span></span>
<span class="line"><span style="color:#79B8FF">        echo</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>Submitting <code>100000010130312</code> to the website yields the flag.</p>
<p>Flag: <code>ENO{Cr4hP_CRC_Collison_1N_P@ssw0rds!}</code></p> </div>  </main> <footer data-astro-cid-sckkx6r4>
&mdash;
<a href="https://github.com/gopherhackumn/website" target="_blank" rel="noopener" data-astro-cid-sckkx6r4>Website source</a>
&mdash;
</footer> </div> </section> </body></html> 